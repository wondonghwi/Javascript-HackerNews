{"mappings":"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","sources":["app.ts"],"sourcesContent":["interface Store {\n  feeds: NewsFeed[];\n  currentPage: number;\n}\n\ninterface News {\n  readonly id: number;\n  readonly time_ago: string;\n  readonly title: string;\n  readonly url: string;\n  readonly user: string;\n  readonly content: string;\n}\n\ninterface NewsFeed extends News {\n  readonly points: number;\n  readonly comments_count: number;\n  read?: boolean;\n}\n\ninterface NewsDetail extends News {\n  readonly comments: NewsComment[];\n}\n\ninterface NewsComment extends News {\n  readonly comments: NewsComment[];\n  readonly level: number;\n}\n\ninterface RouteInfo {\n  path: string;\n  page: View;\n}\n\nconst NEWS_URL = 'https://api.hnpwa.com/v0/news/1.json';\nconst CONTENT_URL = 'https://api.hnpwa.com/v0/item/@id.json';\nconst store: Store = {\n  currentPage: 1,\n  feeds: [],\n};\n\nclass Api {\n  ajax: XMLHttpRequest;\n  url: string;\n\n  constructor(url: string) {\n    this.ajax = new XMLHttpRequest();\n    this.url = url;\n  }\n\n  getRequest<AjaxResponse>(): AjaxResponse {\n    this.ajax.open('GET', this.url, false);\n    this.ajax.send();\n\n    return JSON.parse(this.ajax.response);\n  }\n}\n\nclass NewsFeedApi extends Api {\n  getData(): NewsFeed[] {\n    return this.getRequest<NewsFeed[]>();\n  }\n}\n\nclass NewsDetailApi extends Api {\n  getData(): NewsDetail {\n    return this.getRequest<NewsDetail>();\n  }\n}\n\nabstract class View {\n  private template: string;\n  private renderTemplate: string;\n  private container: HTMLElement;\n  private htmlList: string[];\n\n  constructor(containerId: string, template: string) {\n    const containerElement = document.getElementById(containerId);\n\n    if (!containerElement) {\n      throw '최상위 컨테이너가 없어 UI를 진행하지 못합니다.';\n    }\n\n    this.container = containerElement;\n    this.template = template;\n    this.renderTemplate = template;\n    this.htmlList = [];\n  }\n\n  protected updateView(): void {\n    this.container.innerHTML = this.renderTemplate;\n    this.renderTemplate = this.template;\n  }\n\n  protected addHtml(htmlString: string): void {\n    this.htmlList.push(htmlString);\n  }\n\n  protected getHtml(): string {\n    const snapshot = this.htmlList.join('');\n    this.clearHtmlList();\n    return snapshot;\n  }\n\n  protected setTemplateData(key: string, value: string): void {\n    this.renderTemplate = this.renderTemplate.replace(`{{__${key}__}}`, value);\n  }\n\n  private clearHtmlList(): void {\n    this.htmlList = [];\n  }\n\n  abstract render(): void;\n}\n\nclass Router {\n  routeTable: RouteInfo[];\n  defaultRoute: RouteInfo | null;\n\n  constructor() {\n    window.addEventListener('hashchange', this.route.bind(this));\n\n    this.routeTable = [];\n    this.defaultRoute = null;\n  }\n\n  setDefaultPage(page: View): void {\n    this.defaultRoute = { path: '', page };\n  }\n\n  addRoutePath(path: string, page: View): void {\n    this.routeTable.push({ path, page });\n  }\n\n  route() {\n    const routePath = location.hash;\n\n    if (routePath === '' && this.defaultRoute) {\n      this.defaultRoute.page.render();\n    }\n\n    for (const routeInfo of this.routeTable) {\n      if (routePath.indexOf(routeInfo.path) >= 0) {\n        routeInfo.page.render();\n        break;\n      }\n    }\n  }\n}\nclass NewsFeedView extends View {\n  private api: NewsFeedApi;\n  private feeds: NewsFeed[];\n\n  constructor(containerId: string) {\n    let template: string = `\n      <div class=\"bg-gray-600 min-h-screen\">\n        <div class=\"bg-white text-xl\">\n          <div class=\"mx-auto px-4\">\n            <div class=\"flex justify-between items-center py-6\">\n              <div class=\"flex justify-start\">\n                <h1 class=\"font-extrabold\">Hacker News</h1>\n              </div>\n              <div class=\"items-center justify-end\">\n                <a href=\"#/page/{{__prev_page__}}\" class=\"text-gray-500\">\n                  Previous\n                </a>\n                <a href=\"#/page/{{__next_page__}}\" class=\"text-gray-500 ml-4\">\n                  Next\n                </a>\n              </div>\n            </div> \n          </div>\n        </div>\n        <div class=\"p-4 text-2xl text-gray-700\">\n          {{__news_feed__}}        \n        </div>\n      </div>\n    `;\n\n    super(containerId, template);\n\n    this.api = new NewsFeedApi(NEWS_URL);\n    this.feeds = store.feeds;\n\n    if (this.feeds.length === 0) {\n      this.feeds = store.feeds = this.api.getData();\n      this.makeFeeds();\n    }\n  }\n\n  render(): void {\n    store.currentPage = Number(location.hash.substr(7) || 1);\n\n    for(let i = (store.currentPage - 1) * 10; i < store.currentPage * 10; i++) {\n      const { id, title, comments_count, user, points, time_ago, read } = this.feeds[i];\n      this.addHtml(`\n        <div class=\"p-6 ${read ? 'bg-red-500' : 'bg-white'} mt-6 rounded-lg shadow-md transition-colors duration-500 hover:bg-green-100\">\n          <div class=\"flex\">\n            <div class=\"flex-auto\">\n              <a href=\"#/show/${id}\">${title}</a>  \n            </div>\n            <div class=\"text-center text-sm\">\n              <div class=\"w-10 text-white bg-green-300 rounded-lg px-0 py-2\">${comments_count}</div>\n            </div>\n          </div>\n          <div class=\"flex mt-3\">\n            <div class=\"grid grid-cols-3 text-sm text-gray-500\">\n              <div><i class=\"fas fa-user mr-1\"></i>${user}</div>\n              <div><i class=\"fas fa-heart mr-1\"></i>${points}</div>\n              <div><i class=\"far fa-clock mr-1\"></i>${time_ago}</div>\n            </div>  \n          </div>\n        </div>    \n      `);\n    }\n\n    this.setTemplateData('news_feed', this.getHtml());\n    this.setTemplateData('prev_page', String(store.currentPage > 1 ? store.currentPage - 1 : 1));\n    this.setTemplateData('next_page', String(store.currentPage + 1));\n\n    this.updateView();\n  }\n\n  private makeFeeds(): void {\n    for (let i = 0; i < this.feeds.length; i++) {\n      this.feeds[i].read = false;\n    }\n  }\n}\n\nclass NewsDetailView extends View {\n  constructor(containerId: string) {\n    let template = `\n      <div class=\"bg-gray-600 min-h-screen pb-8\">\n        <div class=\"bg-white text-xl\">\n          <div class=\"mx-auto px-4\">\n            <div class=\"flex justify-between items-center py-6\">\n              <div class=\"flex justify-start\">\n                <h1 class=\"font-extrabold\">Hacker News</h1>\n              </div>\n              <div class=\"items-center justify-end\">\n                <a href=\"#/page/{{__currentPage__}}\" class=\"text-gray-500\">\n                  <i class=\"fa fa-times\"></i>\n                </a>\n              </div>\n            </div>\n          </div>\n        </div>\n  \n        <div class=\"h-full border rounded-xl bg-white m-6 p-4 \">\n          <h2>{{__title__}}</h2>\n          <div class=\"text-gray-400 h-20\">\n            {{__content__}}\n          </div>\n  \n          {{__comments__}}\n  \n        </div>\n      </div>\n    `;\n\n    super(containerId, template);\n  }\n\n  render() {\n    const id = location.hash.substr(7);\n    const api = new NewsDetailApi(CONTENT_URL.replace('@id', id));\n    const newsDetail: NewsDetail = api.getData();\n\n    for(let i=0; i < store.feeds.length; i++) {\n      if (store.feeds[i].id === Number(id)) {\n        store.feeds[i].read = true;\n        break;\n      }\n    }\n\n    this.setTemplateData('comments', this.makeComment(newsDetail.comments))\n    this.setTemplateData('currentPage', String(store.currentPage));\n    this.setTemplateData('title', newsDetail.title);\n    this.setTemplateData('content', newsDetail.content);\n\n    this.updateView();\n  }\n\n  makeComment(comments: NewsComment[]): string {\n    for(let i = 0; i < comments.length; i++) {\n      const comment: NewsComment = comments[i];\n\n      this.addHtml(`\n        <div style=\"padding-left: ${comment.level * 40}px;\" class=\"mt-4\">\n          <div class=\"text-gray-400\">\n            <i class=\"fa fa-sort-up mr-2\"></i>\n            <strong>${comment.user}</strong> ${comment.time_ago}\n          </div>\n          <p class=\"text-gray-700\">${comment.content}</p>\n        </div>      \n      `);\n\n      if (comment.comments.length > 0) {\n        this.addHtml(this.makeComment(comment.comments));\n      }\n    }\n\n    return this.getHtml();\n  }\n}\n\nconst router: Router = new Router();\nconst newsFeedView = new NewsFeedView('root');\nconst newsDetailView = new NewsDetailView('root');\n\nrouter.setDefaultPage(newsFeedView);\n\nrouter.addRoutePath('/page/', newsFeedView);\nrouter.addRoutePath('/show/', newsDetailView);\n\nrouter.route();\n"],"names":[],"version":3,"file":"index.fb2a819c.js.map","sourceRoot":"/__parcel_source_root/"}